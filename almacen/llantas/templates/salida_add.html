{% extends "base_bootstrap.html" %}

{% block title_section %}            
<h1 class="h2">Vale Entrega de llantas, Folio: #{{vale.no_folio}}</h1>
{% endblock %}

{% block extra_title_section %}
  <ul class="pagination">
    <li class="page-item"><a class="page-link" href="{% url 'salida_impresion' vale.id %}">Impresión</a></li>
  </ul>

{% endblock %}


{% block buttons_section %}
     <div class="row">
        <div class="col">No. folio: {{vale.no_folio}}</div>
        <div class="col">Tipo movimiento: {{vale.tipo_movimiento.nombre}}</div>
      </div>
     <div class="row">
        <div class="col">Fecha: {{vale.fecha_vale}}</div>
        <div class="col">Quien entrega: {{vale.persona_asociada.user.first_name}}</div>
      </div>
      <br/><br/>


          <div class="table-responsive">
            <table class="table table-striped table-sm">
              <thead>
                <tr>
                  
                  <th> Cantidad </th>
                  <th> Marca </th>
                  <th> Medida </th>
                  <th> DOT </th>

                  <th> Origen </th>
                  <th> No. Económico </th>
                  <th> Observaciones </th>
                </tr>
              </thead>
              <tbody>
                {% for movimiento in vale.movimientos %}
                <tr>
                  <td>{{movimiento.cantidad}} </td>
                  <td>{{movimiento.marca}} </td>
                  <td>{{movimiento.medida}} </td>
                  <td>{{movimiento.dot}} </td>

                  <td>{{movimiento.origen}} </td>
                  <td>{{movimiento.destino}} </td>
                  <td>{{movimiento.observacion}} </td>
                  
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>



{% endblock %}


{% block section %}

<form action="{% url 'salida_add' vale.id %}" method="post" id="salida_add_form">
    {% csrf_token %}
    {{ form.errors }}
      <div class="form-group">
        {{form.dot.errors}}
        <label for="{{form.dot.id_for_label}}">Dot</label>
        {{form.dot}}
      </div>
    <input type="submit" value="Buscar" class="btn btn-primary">
    <input type="button" value="Limpiar" class="btn btn-secondary" id="boton_limpiar">
</form>


  {% if movimientos %}
  
          <div class="table-responsive">
            <table class="table table-striped table-sm">
              <thead>
                <tr>
                  {% for columna in columnas %} 
                  <th>{{columna}} </th>
                  {% endfor %}
                </tr>
              </thead>
              <tbody>
                {% for movimiento in movimientos %} 
                <tr>
                  {% for x in movimiento.0 %} 
                  <td>{{x}} </td>
                  {% endfor %}
                  <td>{{movimiento.1}}</td>
                  <td>
                    <form action="{% url 'salida_add_movimiento' vale.id %}" method="post" id="salida_add_movimiento_form" class="form-inline">
                      {{form.errors}}
                      {% csrf_token %}
                      {{form_salida.as_p}}
                      <input type="text" value="{% for x in movimiento.0 %}{{x}}{% if forloop.last %}{% else %}__{% endif %}{% endfor %}" name="huella_llanta" id="huella_llanta">
                      <input type="submit" value="Agregar" class="btn btn-primary mb-2">
                    </form>


                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
  {% else %}
    Sin movimientos
  {% endif %}

{% endblock %}

{% block javascript_bottom %}
          <script>
          $( function() {            
            $( "#boton_limpiar" ).click(function(){
                $('#salida_add_form').trigger("reset");
                window.location = "{% url 'salida_add' vale.id %}";
            });
          });
          </script>
{% endblock %}